#!/usr/bin/env python3

import os
import sys
sys.path.insert(1, os.path.join(sys.path[0], ".."))
import binaryaudit.abicheck as abicheck
import binaryaudit.dnf as dnf

def get_grouped_packages(source_dir, out_filename):
    abicheck.generate_package_json(source_dir, out_filename)

def download_old_RPMs(source_dir, json_file):
    dnf.download(source_dir, json_file)

def main(argv):
    if len(argv) != 3:
        print("Pass package directory and JSON output file")
        sys.exit(1)
    source_dir = sys.argv[1]
    out_filename = sys.argv[2]
    get_grouped_packages(source_dir, out_filename)
    download_old_RPMs(source_dir, out_filename)

if __name__ == "__main__":
    main(sys.argv)
